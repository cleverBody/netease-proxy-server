# ç½‘æ˜“äº‘éŸ³ä¹APIä»£ç†æœåŠ¡å™¨

ä¸€ä¸ªç®€å•æ˜“ç”¨çš„ç½‘æ˜“äº‘éŸ³ä¹APIä»£ç†æœåŠ¡å™¨ï¼Œä¸“ä¸ºæœ¬åœ°å¼€å‘å’ŒAPIæµ‹è¯•è®¾è®¡ã€‚æ”¯æŒApifoxã€Postmanç­‰å·¥å…·è¿›è¡Œæ¥å£è°ƒè¯•ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–
```bash
cd netease-proxy-server
npm install
```

### 2. å¯åŠ¨æœåŠ¡å™¨
```bash
# ç”Ÿäº§æ¨¡å¼
npm start

# å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨é‡å¯ï¼‰
npm run dev
```

### 3. éªŒè¯æœåŠ¡
```bash
# è¿è¡Œæµ‹è¯•è„šæœ¬
npm test

# æˆ–è€…ç›´æ¥è®¿é—®
curl http://localhost:3000/health
```

## ğŸ“¡ æœåŠ¡ä¿¡æ¯

- **æœåŠ¡åœ°å€**: http://localhost:3000
- **APIæ–‡æ¡£**: http://localhost:3000/api
- **å¥åº·æ£€æŸ¥**: http://localhost:3000/health

## ğŸ”§ ä½¿ç”¨Apifoxæµ‹è¯•

### 1. é…ç½®ç¯å¢ƒ
1. æ‰“å¼€Apifox
2. åˆ›å»ºæ–°é¡¹ç›®æˆ–ä½¿ç”¨ç°æœ‰é¡¹ç›®
3. æ·»åŠ ç¯å¢ƒå˜é‡ï¼š
   - å˜é‡å: `baseUrl`
   - å˜é‡å€¼: `http://localhost:3000`

### 2. å¯¼å…¥æ¥å£
è®¿é—® http://localhost:3000/api æŸ¥çœ‹å®Œæ•´çš„æ¥å£æ–‡æ¡£å’Œç¤ºä¾‹ã€‚

### 3. å¸¸ç”¨æµ‹è¯•æ¥å£

#### ğŸµ åŸºç¡€éŸ³ä¹æ¥å£

**æœç´¢æ­Œæ›²**
```
GET {{baseUrl}}/api/search?keywords=å‘¨æ°ä¼¦&type=1&limit=10
```

**è·å–æ­Œæ›²è¯¦æƒ…**
```
GET {{baseUrl}}/api/song/detail?ids=186016,186017
```

**è·å–æ’­æ”¾é“¾æ¥**
```
GET {{baseUrl}}/api/song/url/v1?id=186016&level=exhigh
```

**è·å–æ­Œè¯**
```
GET {{baseUrl}}/api/lyric?id=186016
```

#### ğŸ“‹ æ­Œå•ç›¸å…³

**è·å–æ¨èæ­Œå•**
```
GET {{baseUrl}}/api/personalized?limit=10
```

**è·å–æ­Œå•è¯¦æƒ…**
```
GET {{baseUrl}}/api/playlist/detail?id=123456
```

**è·å–æ­Œå•æ‰€æœ‰æ­Œæ›²**
```
GET {{baseUrl}}/api/playlist/track/all?id=123456&limit=100
```

#### ğŸ‘¤ ç”¨æˆ·ç›¸å…³

**æ‰‹æœºå·ç™»å½•**
```
POST {{baseUrl}}/api/login/cellphone
Content-Type: application/json

{
  "phone": "13800138000",
  "password": "your_password"
}
```

**æ£€æŸ¥ç™»å½•çŠ¶æ€**
```
GET {{baseUrl}}/api/login/status
Cookie: MUSIC_U=your_token_here
```

**è·å–ç”¨æˆ·è¯¦æƒ…**
```
GET {{baseUrl}}/api/user/detail?uid=123456
```

#### ğŸ¨ å…¶ä»–æ¥å£

**è·å–çƒ­æœæ¦œ**
```
GET {{baseUrl}}/api/search/hot
```

**è·å–æœç´¢å»ºè®®**
```
GET {{baseUrl}}/api/search/suggest?keywords=å‘¨æ°
```

**è·å–æ¯æ—¥æ¨èæ­Œæ›²**
```
GET {{baseUrl}}/api/recommend/songs
Cookie: MUSIC_U=your_token_here
```

## ğŸ” è®¤è¯è¯´æ˜

### éœ€è¦ç™»å½•çš„æ¥å£
æŸäº›æ¥å£éœ€è¦ç”¨æˆ·ç™»å½•æ‰èƒ½è®¿é—®ï¼Œéœ€è¦åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ Cookieï¼š

```
Cookie: MUSIC_U=your_token_here
```

### è·å–ç™»å½•Token
1. ä½¿ç”¨æ‰‹æœºå·ç™»å½•æ¥å£è·å–Cookie
2. ä»å“åº”ä¸­æå–MUSIC_Uçš„å€¼
3. åœ¨åç»­è¯·æ±‚ä¸­ä½¿ç”¨è¯¥Cookie

## ğŸ“Š å“åº”æ ¼å¼

### æˆåŠŸå“åº”
```json
{
  "success": true,
  "data": {
    // å®é™…æ•°æ®
  },
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

### é”™è¯¯å“åº”
```json
{
  "success": false,
  "error": "é”™è¯¯ä¿¡æ¯",
  "code": 500,
  "path": "/api/example",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

## ğŸ§ª è‡ªåŠ¨åŒ–æµ‹è¯•

é¡¹ç›®åŒ…å«äº†å®Œæ•´çš„æµ‹è¯•è„šæœ¬ï¼Œå¯ä»¥éªŒè¯æ‰€æœ‰ä¸»è¦æ¥å£ï¼š

```bash
npm test
```

æµ‹è¯•å†…å®¹åŒ…æ‹¬ï¼š
- âœ… å¥åº·æ£€æŸ¥
- âœ… APIæ–‡æ¡£è·å–
- âœ… æ­Œæ›²æœç´¢
- âœ… æ­Œæ›²è¯¦æƒ…è·å–
- âœ… æ’­æ”¾é“¾æ¥è·å–
- âœ… æ¨èæ­Œå•è·å–
- âœ… æ­Œè¯è·å–

## ğŸ” è°ƒè¯•æŠ€å·§

### 1. æŸ¥çœ‹è¯·æ±‚æ—¥å¿—
æœåŠ¡å™¨ä¼šè¾“å‡ºè¯¦ç»†çš„è¯·æ±‚æ—¥å¿—ï¼ŒåŒ…æ‹¬ï¼š
- è¯·æ±‚æ–¹æ³•å’Œè·¯å¾„
- è¯·æ±‚å‚æ•°
- APIè°ƒç”¨ç»“æœ
- é”™è¯¯ä¿¡æ¯

### 2. ä½¿ç”¨å¼€å‘æ¨¡å¼
```bash
npm run dev
```
å¼€å‘æ¨¡å¼ä¼šè‡ªåŠ¨é‡å¯æœåŠ¡å™¨ï¼Œæ–¹ä¾¿è°ƒè¯•ã€‚

### 3. æ£€æŸ¥ç½‘æ˜“äº‘APIçŠ¶æ€
å¦‚æœæŸä¸ªæ¥å£è¿”å›é”™è¯¯ï¼Œå¯èƒ½æ˜¯ï¼š
- ç½‘æ˜“äº‘éŸ³ä¹APIä¸´æ—¶ä¸å¯ç”¨
- è¯·æ±‚å‚æ•°ä¸æ­£ç¡®
- éœ€è¦ç™»å½•ä½†æœªæä¾›Cookie
- ç½‘ç»œè¿æ¥é—®é¢˜

## ğŸ“ å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆæŸäº›æ¥å£è¿”å›ç©ºæ•°æ®ï¼Ÿ
A: å¯èƒ½éœ€è¦ç™»å½•ï¼Œè¯·å…ˆè°ƒç”¨ç™»å½•æ¥å£è·å–Cookieã€‚

### Q: å¦‚ä½•è·å–çœŸå®çš„æ­Œæ›²IDï¼Ÿ
A: ä½¿ç”¨æœç´¢æ¥å£ï¼Œä»è¿”å›ç»“æœä¸­è·å–æ­Œæ›²IDã€‚

### Q: æ’­æ”¾é“¾æ¥ä¸ºä»€ä¹ˆæ˜¯ç©ºçš„ï¼Ÿ
A: å¯èƒ½æ˜¯ç‰ˆæƒé™åˆ¶æˆ–éœ€è¦VIPæƒé™ï¼Œå°è¯•å…¶ä»–æ­Œæ›²ã€‚

### Q: æœåŠ¡å™¨å¯åŠ¨å¤±è´¥ï¼Ÿ
A: æ£€æŸ¥ç«¯å£3000æ˜¯å¦è¢«å ç”¨ï¼Œæˆ–ä¿®æ”¹package.jsonä¸­çš„PORTç¯å¢ƒå˜é‡ã€‚

## â˜ï¸ Render.com éƒ¨ç½²

### æ–¹å¼ä¸€ï¼šä½¿ç”¨ render.yamlï¼ˆæ¨èï¼‰

1. **Fork é¡¹ç›®åˆ°ä½ çš„ GitHub**

2. **åœ¨ Render.com åˆ›å»ºæ–°æœåŠ¡**
   - ç™»å½• [Render.com](https://render.com)
   - ç‚¹å‡» "New" > "Blueprint"
   - è¿æ¥ä½ çš„ GitHub ä»“åº“
   - é€‰æ‹©åŒ…å« `render.yaml` çš„ä»“åº“
   - Render ä¼šè‡ªåŠ¨è¯»å–é…ç½®å¹¶éƒ¨ç½²

3. **é…ç½®ä¼šè‡ªåŠ¨åº”ç”¨**
   - æœåŠ¡åï¼š`netease-music-proxy`
   - ç¯å¢ƒï¼šNode.js
   - æ„å»ºå‘½ä»¤ï¼š`npm install`
   - å¯åŠ¨å‘½ä»¤ï¼š`npm start`
   - å¥åº·æ£€æŸ¥ï¼š`/health`

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨é…ç½®

1. **åœ¨ Render.com åˆ›å»º Web Service**
   - é€‰æ‹© "New" > "Web Service"
   - è¿æ¥ä½ çš„ GitHub ä»“åº“

2. **åŸºæœ¬é…ç½®**
   - **Name**: `netease-music-proxy`ï¼ˆæˆ–è‡ªå®šä¹‰åç§°ï¼‰
   - **Root Directory**: `netease-proxy-server`
   - **Environment**: Node
   - **Region**: Oregonï¼ˆæˆ–å…¶ä»–åœ°åŒºï¼‰
   - **Branch**: main

3. **æ„å»ºå’Œéƒ¨ç½²è®¾ç½®**
   - **Build Command**: `npm install`
   - **Start Command**: `npm start`

4. **ç¯å¢ƒå˜é‡**
   - `NODE_ENV`: `production`
   - `PORT`: `10000`ï¼ˆRender è‡ªåŠ¨è®¾ç½®ï¼‰

5. **é«˜çº§è®¾ç½®**
   - **Health Check Path**: `/health`
   - **Auto-Deploy**: Yes

### éƒ¨ç½²åè®¿é—®

éƒ¨ç½²æˆåŠŸåï¼Œä½ ä¼šè·å¾—ä¸€ä¸ªç±»ä¼¼è¿™æ ·çš„åœ°å€ï¼š
- æœåŠ¡åœ°å€ï¼š`https://your-service-name.onrender.com`
- API åŸºç¡€åœ°å€ï¼š`https://your-service-name.onrender.com/api`
- å¥åº·æ£€æŸ¥ï¼š`https://your-service-name.onrender.com/health`

### åœ¨ç§»åŠ¨ç«¯ä¸­ä½¿ç”¨

éƒ¨ç½²å®Œæˆåï¼Œéœ€è¦åœ¨ç§»åŠ¨ç«¯é¡¹ç›®ä¸­æ›´æ–° API åœ°å€ï¼š

1. **ä¿®æ”¹ Capacitor é…ç½®**ï¼ˆ`mobile/capacitor.config.ts`ï¼‰ï¼š
```typescript
server: {
  allowNavigation: [
    'https://your-service-name.onrender.com',
    'https://*.music.126.net',
    'https://*.netease.com'
  ]
}
```

2. **æ›´æ–° API é…ç½®**ï¼ˆ`mobile/src/api/index.ts`ï¼‰ï¼š
```typescript
const API_BASE_URL = 'https://your-service-name.onrender.com/api'
```

## ğŸ› ï¸ è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹ç«¯å£
```bash
PORT=8080 npm start
```

### æ·»åŠ æ–°çš„APIæ¥å£
åœ¨server.jsä¸­ï¼Œæ‰€æœ‰NeteaseCloudMusicApiçš„æ¥å£éƒ½ä¼šè‡ªåŠ¨æ³¨å†Œã€‚å¦‚æœéœ€è¦æ·»åŠ è‡ªå®šä¹‰é€»è¾‘ï¼Œå¯ä»¥åœ¨ç›¸åº”ä½ç½®æ·»åŠ ä¸­é—´ä»¶ã€‚

## ğŸ“„ è®¸å¯è¯

MIT License - ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ã€‚

## âš ï¸ å…è´£å£°æ˜

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ï¼Œè¯·éµå®ˆç½‘æ˜“äº‘éŸ³ä¹çš„æœåŠ¡æ¡æ¬¾ã€‚ä¸å¾—ç”¨äºå•†ä¸šç”¨é€”ã€‚
